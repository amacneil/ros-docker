#!/bin/bash
set -euo pipefail

cd "$(dirname "$0")/.."

case "$1" in
rebuild)
    docker-compose rm -sf
    docker-compose build
    docker-compose up -d
    ;;
restart)
    docker-compose stop
    docker-compose up -d
    ;;
up)
    docker-compose up -d
    ;;
bash)
    docker-compose up -d
    docker-compose exec -u ubuntu app bash
    ;;
ssh)
    docker-compose up -d
    ssh -Y -p 8822 -o XAuthLocation=/opt/X11/bin/xauth ubuntu@localhost
    ;;
tmux)
    docker-compose up -d
    docker-compose exec -u ubuntu app tmux -CC new -A -s tmssh
    ;;
*)
    echo "Usage: bin/dc [up|bash|tmux]"
    exit 1
    ;;
esac
